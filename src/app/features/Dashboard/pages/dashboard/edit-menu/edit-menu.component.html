<div class="edit-menu-container">
  <div class="management-header">
    <h2>Edit Menu</h2>
    <div class="header-actions">
      <button type="button" class="btn-outline-secondary" [routerLink]="['/dashboard/menus']">
        <i class="pi pi-arrow-left"></i> Back to Menus
      </button>
    </div>
  </div>

  <form [formGroup]="menuForm" (ngSubmit)="updateMenu()" class="menu-form">
    <div class="form-card">
      <h3>Basic Information</h3>
      <div class="form-grid">
        <div class="form-group">
          <label for="name">Menu Name *</label>
          <input 
            id="name"
            type="text" 
            class="form-control" 
            [class.is-invalid]="isFieldInvalid('name')"
            formControlName="name"
            placeholder="Enter menu name"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid('name')">
            {{ getFieldError('name') }}
          </div>
        </div>

        <div class="form-group">
          <label for="type">Menu Type *</label>
          <select 
            id="type"
            class="form-control" 
            [class.is-invalid]="isFieldInvalid('type')"
            formControlName="type"
          >
            <option value="">Select Menu Type</option>
            <option value="header">Header Menu</option>
            <option value="footer">Footer Menu</option>
          </select>
          <div class="invalid-feedback" *ngIf="isFieldInvalid('type')">
            {{ getFieldError('type') }}
          </div>
        </div>

        <div class="form-group" *ngIf="menuForm.get('type')?.value === 'header'">
          <label for="headerType">Header Type *</label>
          <select 
            id="headerType"
            class="form-control" 
            [class.is-invalid]="isFieldInvalid('headerType')"
            formControlName="headerType"
          >
            <option value="">Select Header Type</option>
            <option value="top_nav">Top Navigation</option>
            <option value="main_nav">Main Navigation</option>
            <option value="submenu">Sub Menu</option>
          </select>
          <div class="invalid-feedback" *ngIf="isFieldInvalid('headerType')">
            {{ getFieldError('headerType') }}
          </div>
        </div>

        <div class="form-group">
          <div class="form-check">
            <input 
              id="isActive"
              type="checkbox" 
              class="form-check-input"
              formControlName="isActive"
            >
            <label for="isActive" class="form-check-label">Set as Active Menu</label>
          </div>
        </div>
      </div>
    </div>

    <!-- Top Navigation Fields -->
    <div class="form-card" *ngIf="menuForm.get('type')?.value === 'header' && menuForm.get('headerType')?.value === 'top_nav'">
      <h3>Faculty Information</h3>
      <div class="form-grid" formGroupName="facultyInfo">
        <div class="form-group">
          <label for="logoUrl">Logo URL</label>
          <input 
            id="logoUrl"
            type="url" 
            class="form-control" 
            formControlName="logoUrl"
            placeholder="https://example.com/logo.jpg"
          >
        </div>
        <div class="form-group">
          <label for="facultyName">Faculty Name</label>
          <input 
            id="facultyName"
            type="text" 
            class="form-control" 
            formControlName="name"
            placeholder="Faculty of Al-Alsun"
          >
        </div>
        <div class="form-group">
          <label for="subtitle">Subtitle</label>
          <input 
            id="subtitle"
            type="text" 
            class="form-control" 
            formControlName="subtitle"
            placeholder="Luxor University"
          >
        </div>
        <div class="form-group">
          <label for="universityName">University Name</label>
          <input 
            id="universityName"
            type="text" 
            class="form-control" 
            formControlName="universityName"
            placeholder="Luxor University"
          >
        </div>
        <div class="form-group">
          <label for="established">Established Year</label>
          <input 
            id="established"
            type="text" 
            class="form-control" 
            formControlName="established"
            placeholder="2019"
          >
        </div>
      </div>
    </div>

    <!-- Main Navigation Fields -->
    <div class="form-card" *ngIf="menuForm.get('type')?.value === 'header' && menuForm.get('headerType')?.value === 'main_nav'">
      <div class="section-header">
        <h3>Navigation Items</h3>
        <button type="button" class="btn-add-item" (click)="addNavbarItem()">
          <i class="pi pi-plus"></i> Add Navigation Item
        </button>
      </div>
      
      <div formArrayName="navbarItems" class="navbar-items-container">
        <div *ngFor="let item of navbarItemsArray.controls; let i = index" [formGroupName]="i" class="navbar-item-card">
          <div class="item-header">
            <h4>Navigation Item {{ i + 1 }}</h4>
            <button type="button" class="btn-remove" (click)="removeNavbarItem(i)">
              <i class="pi pi-trash"></i>
            </button>
          </div>
          
          <div class="form-grid">
            <div class="form-group">
              <label>Label *</label>
              <input 
                type="text" 
                class="form-control" 
                formControlName="label"
                placeholder="Home, About, etc."
              >
            </div>
            <div class="form-group">
              <label>Icon Class</label>
              <input 
                type="text" 
                class="form-control" 
                formControlName="icon"
                placeholder="pi pi-home"
              >
            </div>
            <div class="form-group">
              <label>Route</label>
              <input 
                type="text" 
                class="form-control" 
                formControlName="route"
                placeholder="/home"
              >
            </div>
          </div>

          <!-- Children Items -->
          <div class="children-section">
            <div class="section-header">
              <h5>Dropdown Items</h5>
              <button type="button" class="btn-add-child" (click)="addNavbarChild(i)">
                <i class="pi pi-plus"></i> Add Dropdown Item
              </button>
            </div>
            
            <div formArrayName="children">
              <div *ngFor="let child of getNavbarChildrenArray(i).controls; let j = index" [formGroupName]="j" class="child-item">
                <div class="item-header">
                  <h6>Dropdown Item {{ j + 1 }}</h6>
                  <button type="button" class="btn-remove-child" (click)="removeNavbarChild(i, j)">
                    <i class="pi pi-times"></i>
                  </button>
                </div>
                <div class="form-grid">
                  <div class="form-group">
                    <label>Label *</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="label"
                      placeholder="Dropdown item label"
                    >
                  </div>
                  <div class="form-group">
                    <label>Icon Class</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="icon"
                      placeholder="pi pi-users"
                    >
                  </div>
                  <div class="form-group">
                    <label>Route</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="route"
                      placeholder="/sectors/education"
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Submenu Fields -->
    <div class="form-card" *ngIf="menuForm.get('type')?.value === 'header' && menuForm.get('headerType')?.value === 'submenu'">
      <h3>Submenu Configuration</h3>
      <div formGroupName="submenu">
        <div class="form-group">
          <label for="copyright">Copyright Text</label>
          <input 
            id="copyright"
            type="text" 
            class="form-control" 
            formControlName="copyright"
            placeholder="© 2025 Faculty Name. All rights reserved."
          >
        </div>
        
        <h4>Contact Methods</h4>
        <div formGroupName="contactMethods" class="form-grid">
          <div class="form-group">
            <label for="phone">Phone</label>
            <input 
              id="phone"
              type="tel" 
              class="form-control" 
              formControlName="phone"
              placeholder="+20 95 237 1000"
            >
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input 
              id="email"
              type="email" 
              class="form-control" 
              formControlName="email"
              placeholder="info@faculty.edu"
            >
          </div>
          <div class="form-group">
            <label for="universityWebsite">University Website</label>
            <input 
              id="universityWebsite"
              type="url" 
              class="form-control" 
              formControlName="universityWebsite"
              placeholder="https://university.edu"
            >
          </div>
        </div>

        <!-- Languages -->
        <div class="languages-section">
          <div class="section-header">
            <h4>Languages</h4>
            <button type="button" class="btn-add-item" (click)="addSubmenuLanguage()">
              <i class="pi pi-plus"></i> Add Language
            </button>
          </div>
          <div formArrayName="languages">
            <div *ngFor="let lang of submenuLanguagesArray.controls; let i = index" [formGroupName]="i" class="language-item">
              <div class="item-header">
                <h5>Language {{ i + 1 }}</h5>
                <button type="button" class="btn-remove" (click)="removeSubmenuLanguage(i)">
                  <i class="pi pi-trash"></i>
                </button>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Value *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    formControlName="value"
                    placeholder="en"
                  >
                </div>
                <div class="form-group">
                  <label>Label *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    formControlName="label"
                    placeholder="English"
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer Fields -->
    <div class="form-card" *ngIf="menuForm.get('type')?.value === 'footer'">
      <h3>Footer Configuration</h3>
      <div formGroupName="footerData">
        <div class="form-grid">
          <div class="form-group">
            <label for="logoIcon">Logo Icon</label>
            <input 
              id="logoIcon"
              type="text" 
              class="form-control" 
              formControlName="logoIcon"
              placeholder="pi pi-book"
            >
          </div>
          <div class="form-group">
            <label for="footerTitle">Title</label>
            <input 
              id="footerTitle"
              type="text" 
              class="form-control" 
              formControlName="title"
              placeholder="Faculty of Al-Alsun"
            >
          </div>
          <div class="form-group">
            <label for="footerSubtitle">Subtitle</label>
            <input 
              id="footerSubtitle"
              type="text" 
              class="form-control" 
              formControlName="subtitle"
              placeholder="Luxor University"
            >
          </div>
          <div class="form-group">
            <label for="tagline">Tagline</label>
            <input 
              id="tagline"
              type="text" 
              class="form-control" 
              formControlName="tagline"
              placeholder="Excellence in education"
            >
          </div>
          <div class="form-group">
            <label for="footerCopyright">Copyright</label>
            <input 
              id="footerCopyright"
              type="text" 
              class="form-control" 
              formControlName="copyright"
              placeholder="© 2025 Faculty Name. All Rights Reserved."
            >
          </div>
        </div>

        <!-- Social Links -->
        <div class="social-links-section">
          <div class="section-header">
            <h4>Social Media Links</h4>
            <button type="button" class="btn-add-item" (click)="addFooterSocialLink()">
              <i class="pi pi-plus"></i> Add Social Link
            </button>
          </div>
          <div formArrayName="socialLinks">
            <div *ngFor="let link of footerSocialLinksArray.controls; let i = index" [formGroupName]="i" class="social-link-item">
              <div class="item-header">
                <h5>Social Link {{ i + 1 }}</h5>
                <button type="button" class="btn-remove" (click)="removeFooterSocialLink(i)">
                  <i class="pi pi-trash"></i>
                </button>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Platform *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    formControlName="platform"
                    placeholder="Facebook"
                  >
                </div>
                <div class="form-group">
                  <label>URL *</label>
                  <input 
                    type="url" 
                    class="form-control" 
                    formControlName="url"
                    placeholder="https://facebook.com/page"
                  >
                </div>
                <div class="form-group">
                  <label>Icon *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    formControlName="icon"
                    placeholder="pi pi-facebook"
                  >
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Quick Links -->
        <div class="links-section">
          <div class="section-header">
            <h4>Quick Links</h4>
            <button type="button" class="btn-add-item" (click)="addFooterQuickLink()">
              <i class="pi pi-plus"></i> Add Quick Link
            </button>
          </div>
          <div formGroupName="quickLinks">
            <div class="form-group">
              <label for="quickLinksTitle">Section Title</label>
              <input 
                id="quickLinksTitle"
                type="text" 
                class="form-control" 
                formControlName="title"
                placeholder="Quick Links"
              >
            </div>
            <div formArrayName="links">
              <div *ngFor="let link of footerQuickLinksArray.controls; let i = index" [formGroupName]="i" class="link-item">
                <div class="item-header">
                  <h5>Link {{ i + 1 }}</h5>
                  <button type="button" class="btn-remove" (click)="removeFooterQuickLink(i)">
                    <i class="pi pi-trash"></i>
                  </button>
                </div>
                <div class="form-grid">
                  <div class="form-group">
                    <label>Title *</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="title"
                      placeholder="About Us"
                    >
                  </div>
                  <div class="form-group">
                    <label>URL *</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="url"
                      placeholder="/about"
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Academic Links -->
        <div class="links-section">
          <div class="section-header">
            <h4>Academic Links</h4>
            <button type="button" class="btn-add-item" (click)="addFooterAcademicLink()">
              <i class="pi pi-plus"></i> Add Academic Link
            </button>
          </div>
          <div formGroupName="academicLinks">
            <div class="form-group">
              <label for="academicLinksTitle">Section Title</label>
              <input 
                id="academicLinksTitle"
                type="text" 
                class="form-control" 
                formControlName="title"
                placeholder="Academic Links"
              >
            </div>
            <div formArrayName="links">
              <div *ngFor="let link of footerAcademicLinksArray.controls; let i = index" [formGroupName]="i" class="link-item">
                <div class="item-header">
                  <h5>Link {{ i + 1 }}</h5>
                  <button type="button" class="btn-remove" (click)="removeFooterAcademicLink(i)">
                    <i class="pi pi-trash"></i>
                  </button>
                </div>
                <div class="form-grid">
                  <div class="form-group">
                    <label>Title *</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="title"
                      placeholder="Academic Programs"
                    >
                  </div>
                  <div class="form-group">
                    <label>URL *</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="url"
                      placeholder="/programs"
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Resource Links -->
        <div class="links-section">
          <div class="section-header">
            <h4>Resource Links</h4>
            <button type="button" class="btn-add-item" (click)="addFooterResourceLink()">
              <i class="pi pi-plus"></i> Add Resource Link
            </button>
          </div>
          <div formGroupName="resourceLinks">
            <div class="form-group">
              <label for="resourceLinksTitle">Section Title</label>
              <input 
                id="resourceLinksTitle"
                type="text" 
                class="form-control" 
                formControlName="title"
                placeholder="Resource Links"
              >
            </div>
            <div formArrayName="links">
              <div *ngFor="let link of footerResourceLinksArray.controls; let i = index" [formGroupName]="i" class="link-item">
                <div class="item-header">
                  <h5>Link {{ i + 1 }}</h5>
                  <button type="button" class="btn-remove" (click)="removeFooterResourceLink(i)">
                    <i class="pi pi-trash"></i>
                  </button>
                </div>
                <div class="form-grid">
                  <div class="form-group">
                    <label>Title *</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="title"
                      placeholder="Library"
                    >
                  </div>
                  <div class="form-group">
                    <label>URL *</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="url"
                      placeholder="/library"
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Contact Methods -->
        <div class="links-section">
          <h4>Contact Methods</h4>
          <div formGroupName="contactMethods" class="form-grid">
            <div class="form-group">
              <label for="footerPhone">Phone</label>
              <input 
                id="footerPhone"
                type="tel" 
                class="form-control" 
                formControlName="phone"
                placeholder="+20 95 237 1000"
              >
            </div>
            <div class="form-group">
              <label for="footerEmail">Email</label>
              <input 
                id="footerEmail"
                type="email" 
                class="form-control" 
                formControlName="email"
                placeholder="info@faculty.edu"
              >
            </div>
            <div class="form-group">
              <label for="footerUniversityWebsite">University Website</label>
              <input 
                id="footerUniversityWebsite"
                type="url" 
                class="form-control" 
                formControlName="universityWebsite"
                placeholder="https://university.edu"
              >
            </div>
          </div>

          <!-- Contact Languages -->
          <div class="languages-section">
            <div class="section-header">
              <h4>Languages</h4>
              <button type="button" class="btn-add-item" (click)="addFooterContactLanguage()">
                <i class="pi pi-plus"></i> Add Language
              </button>
            </div>
            <div formArrayName="languages">
              <div *ngFor="let lang of footerContactLanguagesArray.controls; let i = index" [formGroupName]="i" class="language-item">
                <div class="item-header">
                  <h5>Language {{ i + 1 }}</h5>
                  <button type="button" class="btn-remove" (click)="removeFooterContactLanguage(i)">
                    <i class="pi pi-trash"></i>
                  </button>
                </div>
                <div class="form-grid">
                  <div class="form-group">
                    <label>Value *</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="value"
                      placeholder="en"
                    >
                  </div>
                  <div class="form-group">
                    <label>Label *</label>
                    <input 
                      type="text" 
                      class="form-control" 
                      formControlName="label"
                      placeholder="English"
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="form-actions">
      <button type="button" class="btn-outline-secondary" [routerLink]="['/dashboard/menus']">
        <i class="pi pi-times"></i> Cancel
      </button>
      <button type="submit" class="btn-primary-custom" [disabled]="menuForm.invalid">
        <i class="pi pi-check"></i> Update Menu
      </button>
    </div>
  </form>

  <!-- Toast Messages -->
  <div class="toast-container" *ngIf="showToast">
    <div class="toast" [class]="toastClass">
      <div class="toast-content">
        <i [class]="toastIcon"></i>
        <span>{{ toastMessage }}</span>
      </div>
      <button type="button" class="toast-close" (click)="hideToast()">×</button>
    </div>
  </div>
</div>